// -----------------------------------------------------------------------------
//  Generated by Magillem, from Arteris IPD division
//  Version: 5.16.0 (20230705092541_5.16.0)
//  Date   : 2024-07-18 20:46:55
// -----------------------------------------------------------------------------
//  Verilog Register Bank
// -----------------------------------------------------------------------------
//  Component Name: TOD_TS_Registers
//  File Ref      : /nfs/site/disks/ceg_user_bkhantwa/ipxact/csrgen_output/_workspace_mrv_gen_py_/xmlProject/_local_copy_Vendor_Library_TOD_TS_Registers_1.0.xml
//  Protocol      : AVALON
//  Wait State    : WS1_OUTPUT
// -----------------------------------------------------------------------------

module TOD_TS_Registers(

   // tod_control.load_tod
   output reg tod_control_load_tod,
   // tod_control.comparator
   output reg tod_control_comparator,
   // nanoseconds.nanoseconds
   output reg [31:0] nanoseconds_nanoseconds,
   // fr_nanoseconds.fractional_nanoseconds
   output reg [15:0] fr_nanoseconds_fractional_nanoseconds,
   // seconds_msb.seconds_msb
   output reg [15:0] seconds_msb_seconds_msb,
   // seconds_lsb.seconds_lsb
   output reg [31:0] seconds_lsb_seconds_lsb,
   // ram_status_rfp_pul.ram_rdusedw
   input wire [12:0] ram_status_rfp_pul_ram_rdusedw_i,
   // ram_status_rfp_pul.ram_rdempty
   input wire ram_status_rfp_pul_ram_rdempty_i,
   // ram_status_rfp_pul.rfp_sync_pul
   input wire ram_status_rfp_pul_rfp_sync_pul_i,

   // Bus interface
   input wire clk,
   input wire reset,
   input wire [31:0] writedata,
   input wire read,
   input wire write,
   input wire [3:0] byteenable,
   output reg [31:0] readdata,
   output reg readdatavalid,
   input wire [4:0] address
);

wire reset_n = !reset;

// -----------------------------------------------------------------------------
// Protocol management
// -----------------------------------------------------------------------------

reg [31:0] rdata_comb;
always @(negedge reset_n, posedge clk)
   if (!reset_n) readdata[31:0] <= 32'h00000000; else readdata[31:0] <= rdata_comb[31:0];

// Read data is always valid the cycle after read transaction is asserted
always @(negedge reset_n, posedge clk)
   if (!reset_n) readdatavalid <= 1'b0; else readdatavalid <= read;

wire we = write;
wire re = read;
wire [4:0] addr = address[4:0];
wire [31:0] din = writedata[31:0];

// -----------------------------------------------------------------------------
// Write byte enables
// -----------------------------------------------------------------------------

// Register tod_control
wire we_tod_control = we & (addr[4:0] == 5'h00) ? byteenable[0] : 1'b0;
// Register nanoseconds
wire [3:0] we_nanoseconds = we & (addr[4:0] == 5'h04) ? byteenable[3:0] : {4{1'b0}};
// Register fr_nanoseconds
wire [1:0] we_fr_nanoseconds = we & (addr[4:0] == 5'h08) ? byteenable[1:0] : {2{1'b0}};
// Register seconds_msb
wire [1:0] we_seconds_msb = we & (addr[4:0] == 5'h0c) ? byteenable[1:0] : {2{1'b0}};
// Register seconds_lsb
wire [3:0] we_seconds_lsb = we & (addr[4:0] == 5'h10) ? byteenable[3:0] : {4{1'b0}};

// -----------------------------------------------------------------------------
// Read byte enables
// -----------------------------------------------------------------------------

// -----------------------------------------------------------------------------
// Register tod_control implementation
// -----------------------------------------------------------------------------

// tod_control_load_tod
//    bitfield description: set to '1' to load value to ToD IP
//    customType          : RW
//    hwAccess            : RO
//    reset value         : 1'h0

always @(negedge reset_n, posedge clk)
   if (!reset_n) begin
      tod_control_load_tod <= 1'h0;
   end
   else begin
      if (we_tod_control) begin
         tod_control_load_tod <= din[0];
      end
   end

// tod_control_comparator
//    bitfield description: set to '1' comparator
//    customType          : RW
//    hwAccess            : RO
//    reset value         : 1'h0

always @(negedge reset_n, posedge clk)
   if (!reset_n) begin
      tod_control_comparator <= 1'h0;
   end
   else begin
      if (we_tod_control) begin
         tod_control_comparator <= din[1];
      end
   end

// -----------------------------------------------------------------------------
// Register nanoseconds implementation
// -----------------------------------------------------------------------------

// nanoseconds_nanoseconds
//    bitfield description: Nanoseconds
//    customType          : RW
//    hwAccess            : RO
//    reset value         : 32'h00000000

always @(negedge reset_n, posedge clk)
   if (!reset_n) begin
      nanoseconds_nanoseconds <= 32'h00000000;
   end
   else begin
      if (we_nanoseconds[0]) begin
         nanoseconds_nanoseconds[7:0] <= din[7:0];
      end
      if (we_nanoseconds[1]) begin
         nanoseconds_nanoseconds[15:8] <= din[15:8];
      end
      if (we_nanoseconds[2]) begin
         nanoseconds_nanoseconds[23:16] <= din[23:16];
      end
      if (we_nanoseconds[3]) begin
         nanoseconds_nanoseconds[31:24] <= din[31:24];
      end
   end

// -----------------------------------------------------------------------------
// Register fr_nanoseconds implementation
// -----------------------------------------------------------------------------

// fr_nanoseconds_fractional_nanoseconds
//    bitfield description: Fractional Nanoseconds
//    customType          : RW
//    hwAccess            : RO
//    reset value         : 16'h0000

always @(negedge reset_n, posedge clk)
   if (!reset_n) begin
      fr_nanoseconds_fractional_nanoseconds <= 16'h0000;
   end
   else begin
      if (we_fr_nanoseconds[0]) begin
         fr_nanoseconds_fractional_nanoseconds[7:0] <= din[7:0];
      end
      if (we_fr_nanoseconds[1]) begin
         fr_nanoseconds_fractional_nanoseconds[15:8] <= din[15:8];
      end
   end

// -----------------------------------------------------------------------------
// Register seconds_msb implementation
// -----------------------------------------------------------------------------

// seconds_msb_seconds_msb
//    bitfield description: Seconds MSB
//    customType          : RW
//    hwAccess            : RO
//    reset value         : 16'h0000

always @(negedge reset_n, posedge clk)
   if (!reset_n) begin
      seconds_msb_seconds_msb <= 16'h0000;
   end
   else begin
      if (we_seconds_msb[0]) begin
         seconds_msb_seconds_msb[7:0] <= din[7:0];
      end
      if (we_seconds_msb[1]) begin
         seconds_msb_seconds_msb[15:8] <= din[15:8];
      end
   end

// -----------------------------------------------------------------------------
// Register seconds_lsb implementation
// -----------------------------------------------------------------------------

// seconds_lsb_seconds_lsb
//    bitfield description: Seconds LSB
//    customType          : RW
//    hwAccess            : RO
//    reset value         : 32'h00000000

always @(negedge reset_n, posedge clk)
   if (!reset_n) begin
      seconds_lsb_seconds_lsb <= 32'h00000000;
   end
   else begin
      if (we_seconds_lsb[0]) begin
         seconds_lsb_seconds_lsb[7:0] <= din[7:0];
      end
      if (we_seconds_lsb[1]) begin
         seconds_lsb_seconds_lsb[15:8] <= din[15:8];
      end
      if (we_seconds_lsb[2]) begin
         seconds_lsb_seconds_lsb[23:16] <= din[23:16];
      end
      if (we_seconds_lsb[3]) begin
         seconds_lsb_seconds_lsb[31:24] <= din[31:24];
      end
   end

// -----------------------------------------------------------------------------
// Register ram_status_rfp_pul implementation
// -----------------------------------------------------------------------------

// ram_status_rfp_pul_ram_rdusedw
//    bitfield description: Bit [12:0] - Read Used Word
//    customType          : RO
//    hwAccess            : WO
//    reset value         : 13'h0000
//    inputPort           : ram_status_rfp_pul_ram_rdusedw_i
//
// No register generated

// ram_status_rfp_pul_ram_rdempty
//    bitfield description: Bit [13] - Read Empty
//    customType          : RO
//    hwAccess            : WO
//    reset value         : 1'h1
//    inputPort           : ram_status_rfp_pul_ram_rdempty_i
//
// No register generated

// ram_status_rfp_pul_rfp_sync_pul
//    bitfield description: Bit [14] - RFP Sync Pulse
//    customType          : RO
//    hwAccess            : WO
//    reset value         : 1'h0
//    inputPort           : ram_status_rfp_pul_rfp_sync_pul_i
//
// No register generated

// -----------------------------------------------------------------------------
// Data read management
// -----------------------------------------------------------------------------

always @(*)
begin
   rdata_comb = 32'h00000000;
   if (re) begin
      case (addr)
         // Register tod_control: tod_control_load_tod (RW)
         //                       tod_control_comparator (RW)
         5'h00: begin
            rdata_comb[0] = tod_control_load_tod;
            rdata_comb[1] = tod_control_comparator;
         end
         // Register nanoseconds: nanoseconds_nanoseconds (RW)
         5'h04: begin
            rdata_comb[31:0] = nanoseconds_nanoseconds[31:0];
         end
         // Register fr_nanoseconds: fr_nanoseconds_fractional_nanoseconds (RW)
         5'h08: begin
            rdata_comb[15:0] = fr_nanoseconds_fractional_nanoseconds[15:0];
         end
         // Register seconds_msb: seconds_msb_seconds_msb (RW)
         5'h0c: begin
            rdata_comb[15:0] = seconds_msb_seconds_msb[15:0];
         end
         // Register seconds_lsb: seconds_lsb_seconds_lsb (RW)
         5'h10: begin
            rdata_comb[31:0] = seconds_lsb_seconds_lsb[31:0];
         end
         // Register ram_status_rfp_pul: ram_status_rfp_pul_ram_rdusedw (RO)
         //                              ram_status_rfp_pul_ram_rdempty (RO)
         //                              ram_status_rfp_pul_rfp_sync_pul (RO)
         5'h14: begin
            rdata_comb[12:0] = ram_status_rfp_pul_ram_rdusedw_i[12:0];
            rdata_comb[13] = ram_status_rfp_pul_ram_rdempty_i;
            rdata_comb[14] = ram_status_rfp_pul_rfp_sync_pul_i;
         end
         default: begin
            rdata_comb = 32'h00000000;
         end
      endcase
   end
end

endmodule